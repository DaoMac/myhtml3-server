# ğŸ“š GIáº¢I THÃCH NGUYÃŠN LÃ Há»† THá»NG ÄÄ‚NG NHáº¬P & KIá»‚M SOÃT BÄ‚NG THÃ”NG

## ğŸ—ï¸ KIáº¾N TRÃšC Há»† THá»NG

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OPPO A71 SERVER (4MB/s)                     â”‚
â”‚                   Cá»•ng 3000 - Node.js Express                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1ï¸âƒ£  TRANG ÄÄ‚NG NHáº¬P (/dangnhap)          â”‚
        â”‚     - Form nháº­p user/password              â”‚
        â”‚     - XÃ¡c thá»±c: admin / 123456789 (9 kÃ½)  â”‚
        â”‚     - Táº¡o SESSION lÆ°u trá»¯ 24h             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2ï¸âƒ£  TRANG HUB (/GETinteractive.html)     â”‚
        â”‚     - Dashboard/Menu chÃ­nh                â”‚
        â”‚     - Danh sÃ¡ch á»©ng dá»¥ng cÃ³ thá»ƒ vÃ o       â”‚
        â”‚     - NÃºt ÄÄƒng xuáº¥t táº¡i Ä‘Ã¢y               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†™      â†“      â†˜
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚          â”‚          â”‚
        â†“              â†“          â†“          â†“
   Trang Chá»§    ThÆ° Viá»‡n    Video      CÃ i Äáº·t
   (mainpage)    áº¢nh      Player      (phÃ¡t triá»ƒn)
        â”‚
        â””â”€â†’ Container-5 (Profile) 
            â”œâ”€ Hiá»ƒn thá»‹ thÃ´ng tin user
            â”œâ”€ IP Ä‘á»‹a chá»‰
            â”œâ”€ Thá»i gian Ä‘Äƒng nháº­p
            â”œâ”€ Dung lÆ°á»£ng sá»­ dá»¥ng
            â””â”€ NÃšT ÄÄ‚NG XUáº¤T â† NÆ¡i duy nháº¥t cÃ³ logout
```

---

## ğŸ” QUY TRÃŒNH ÄÄ‚NG NHáº¬P CHI TIáº¾T

### 1ï¸âƒ£ **User Truy Cáº­p Trang**
```
User â†’ http://localhost:3000
  â†“
Middleware kiá»ƒm tra session
  â”œâ”€ Náº¿u Ä‘Ã£ Ä‘Äƒng nháº­p â†’ Chuyá»ƒn hÆ°á»›ng tá»›i GETinteractive.html
  â””â”€ Náº¿u chÆ°a Ä‘Äƒng nháº­p â†’ Chuyá»ƒn hÆ°á»›ng tá»›i /dangnhap
```

### 2ï¸âƒ£ **Form ÄÄƒng Nháº­p**
```html
<!-- dangnhap.html -->
<input type="text" id="username" name="username">
<input type="password" id="password" name="password" maxlength="20">
<!-- Máº­t kháº©u pháº£i ÄÃšNG 9 kÃ½ tá»± -->
```

**JavaScript kiá»ƒm tra:**
```javascript
if (password.length !== 9) {
  showError('âŒ Máº­t kháº©u pháº£i Ä‘Ãºng 9 kÃ½ tá»±!');
  return;
}

// Gá»­i POST tá»›i /xuly-dangnhap
fetch('/xuly-dangnhap', {
  method: 'POST',
  body: JSON.stringify({ username, password })
})
```

### 3ï¸âƒ£ **Server XÃ¡c Thá»±c** (maychu.js)
```javascript
app.post('/xuly-dangnhap', (req, res) => {
  const { username, password } = req.body;
  
  if (password.length === 9 && 
      username === 'admin' && 
      password === '123456789') {
    
    // âœ… ÄÃºng - Táº¡o session
    req.session.daDangNhap = true;
    req.session.username = username;           // LÆ°u tÃªn user
    req.session.loginTime = new Date();        // LÆ°u thá»i gian
    req.session.clientIP = req.ip;             // LÆ°u IP client
    
    return res.json({ success: true });
  } else {
    // âŒ Sai - Tá»« chá»‘i
    return res.json({ 
      success: false, 
      msg: 'Sai tÃ i khoáº£n hoáº·c máº­t kháº©u!' 
    });
  }
});
```

### 4ï¸âƒ£ **Chuyá»ƒn HÆ°á»›ng Tá»›i Hub**
```javascript
// Náº¿u thÃ nh cÃ´ng, client chuyá»ƒn hÆ°á»›ng:
window.location.href = '/';  // â†’ GETinteractive.html
```

---

## ğŸ¯ Cáº¤U TRÃšC TRANG CHÃNH (mainpage.html)

### **5 Container (Tab/Section)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           TRANG CHÃNH (mainpage)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Container-1: Trang Chá»§                  â”‚
â”‚ Container-2: Táº£i File lÃªn / TÃ¬m file    â”‚
â”‚ Container-3: Video Short (khÃ¡c)         â”‚
â”‚ Container-4: Music Player               â”‚
â”‚ Container-5: PROFILE (ğŸ‘¤) â† NÃšT LOGOUT  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nav Bar: [ğŸ ] [ğŸ“] [ğŸ¬] [ğŸµ] [ğŸ‘¤]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Container-5 (Profile)**
```html
<div id="container-5">
  <div class="profile-card">
    <h2 id="profileUsername">admin</h2>
    <div class="info-item">
      <span>ğŸ” Tráº¡ng ThÃ¡i</span>
      <span>ÄÃ£ XÃ¡c Thá»±c</span>
    </div>
    <div class="info-item">
      <span>ğŸ“± Thiáº¿t Bá»‹</span>
      <span id="deviceInfo">Äiá»‡n Thoáº¡i (Android)</span>
    </div>
    <div class="info-item">
      <span>ğŸŒ IP Address</span>
      <span id="ipAddress">192.168.1.100</span>
    </div>
    <a href="/dangxuat" class="logout-btn-profile">
      ğŸ”“ ÄÄƒng Xuáº¥t
    </a>
  </div>
</div>
```

---

## ğŸ“Š KIá»‚M SOÃT BÄ‚NG THÃ”NG (Bandwidth Control)

### **Táº¡i Sao Cáº§n Kiá»ƒm SoÃ¡t?**
- Server Oppo A71 chá»‰ cÃ³ 4MB/s
- Náº¿u khÃ´ng kiá»ƒm soÃ¡t â†’ nhiá»u client download cÃ¹ng lÃºc â†’ server quÃ¡ táº£i
- Giáº£i phÃ¡p: Giá»›i háº¡n Má»–I IP Ä‘á»‹a chá»‰ á»Ÿ 4MB/s

### **CÃ¡ch Hoáº¡t Äá»™ng**

**1. Middleware Tracking (maychu.js)**
```javascript
const bandwidthControl = {
  limits: {
    upload: 4 * 1024 * 1024,    // 4 MB/s
    download: 4 * 1024 * 1024   // 4 MB/s
  },
  perIP: {}  // LÆ°u dá»¯ liá»‡u theo tá»«ng IP
};

function bandwidthMiddleware(req, res, next) {
  const clientIP = req.ip;  // Láº¥y IP client
  
  // Khá»Ÿi táº¡o tracking náº¿u IP chÆ°a tá»«ng request
  if (!bandwidthControl.perIP[clientIP]) {
    bandwidthControl.perIP[clientIP] = {
      uploadedThisWindow: 0,
      downloadedThisWindow: 0,
      lastResetTime: Date.now()
    };
  }
  
  // Reset náº¿u quÃ¡ 1 giÃ¢y
  if (now - tracking.lastResetTime > 1000) {
    tracking.uploadedThisWindow = 0;
    tracking.downloadedThisWindow = 0;
    tracking.lastResetTime = now;
  }
  
  next();
}
```

**2. Endpoint Download Vá»›i Kiá»ƒm SoÃ¡t Tá»‘c Äá»™**
```javascript
app.get('/download/:filename', (req, res) => {
  const fileSize = fs.statSync(filePath).size;
  const maxBytesPerSecond = 4 * 1024 * 1024;  // 4MB/s
  
  const stream = fs.createReadStream(filePath);
  let sentBytes = 0;
  let startTime = Date.now();
  
  stream.on('data', (chunk) => {
    sentBytes += chunk.length;
    const elapsed = (Date.now() - startTime) / 1000;
    const expectedBytes = maxBytesPerSecond * elapsed;
    
    // Náº¿u vÆ°á»£t quÃ¡, táº¡m dá»«ng stream
    if (sentBytes > expectedBytes * 1.1) {
      stream.pause();
      const delay = (sentBytes / maxBytesPerSecond - elapsed) * 1000;
      setTimeout(() => stream.resume(), delay);
    }
  });
  
  stream.pipe(res);
});
```

**VÃ­ dá»¥ Timeline:**
```
Thá»i gian (giÃ¢y)  ÄÃ£ táº£i (MB)  Mong muá»‘n (MB)  HÃ nh Ä‘á»™ng
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0                 0            0               Báº¯t Ä‘áº§u
0.5               2.0          2.0             OK âœ…
1.0               4.0          4.0             OK âœ…
1.5               6.0          6.0             PAUSE! (quÃ¡ 1.1x) â¸ï¸
2.0               6.2          8.0             RESUME (catch up) â–¶ï¸
2.5               8.0          10.0            OK âœ…
```

---

## ğŸ”— CÃC ENDPOINT CHÃNH

### **ÄÄƒng Nháº­p / ÄÄƒng Xuáº¥t**
| Endpoint | Method | MÃ´ Táº£ |
|----------|--------|-------|
| `/dangnhap` | GET | Trang login |
| `/xuly-dangnhap` | POST | XÃ¡c thá»±c user/password |
| `/dangxuat` | GET | Logout & xÃ³a session |

### **Láº¥y ThÃ´ng Tin User**
| Endpoint | Method | MÃ´ Táº£ |
|----------|--------|-------|
| `/get-user-info` | GET | Láº¥y username + login time |
| `/get-client-ip` | GET | Láº¥y IP client |
| `/get-storage-usage` | GET | Láº¥y dung lÆ°á»£ng Ä‘Ã£ dÃ¹ng |

### **File Operations**
| Endpoint | Method | MÃ´ Táº£ |
|----------|--------|-------|
| `/guifile` | POST | Upload file (kiá»ƒm soÃ¡t tá»‘c Ä‘á»™) |
| `/download/:filename` | GET | Download file (4MB/s) |
| `/timfile` | GET | TÃ¬m file theo extension |

---

## ğŸ“± CÃCH HOáº T Äá»˜NG TrÃªn OPPO A71

### **Server Side (MÃ¡y tÃ­nh cháº¡y Node.js)**
```bash
npm install express cors multer express-session unidecode file-type
node server/maychu.js
# Output: âœ… Server cháº¡y táº¡i http://0.0.0.0:3000
```

### **Client Side (TrÃªn Oppo A71 Browser)**
```
BÆ°á»›c 1: Má»Ÿ http://192.168.1.x:3000
BÆ°á»›c 2: Nháº­p admin / 123456789
BÆ°á»›c 3: VÃ o Hub (GETinteractive)
BÆ°á»›c 4: Chá»n Trang ChÃ­nh
BÆ°á»›c 5: Báº¥m [ğŸ‘¤] Profile â†’ Logout
```

---

## âš™ï¸ Cáº¤U HÃŒNH CÃ“ THá»‚ THAY Äá»”I

### **1. Äá»•i TÃ i Khoáº£n/Máº­t Kháº©u**
File: `server/maychu.js`
```javascript
const TAI_KHOAN_ADMIN = {
  user: 'admin',           // â† Thay tÃªn á»Ÿ Ä‘Ã¢y
  pass: '123456789'        // â† Thay máº­t kháº©u 9 kÃ½ (báº¯t buá»™c)
};
```

### **2. Thay Äá»•i Tá»‘c Äá»™ BÄƒng ThÃ´ng**
```javascript
const bandwidthControl = {
  limits: {
    upload: 8 * 1024 * 1024,    // Thay tá»« 4 thÃ nh 8 MB/s
    download: 8 * 1024 * 1024
  }
};
```

### **3. Thay Äá»•i Thá»i Háº¡n Session**
```javascript
app.use(session({
  cookie: { 
    maxAge: 48 * 60 * 60 * 1000  // Thay tá»« 24h thÃ nh 48h
  }
}));
```

---

## ğŸ”’ Báº¢O Máº¬T

1. **Session Signing**: Express-session sá»­ dá»¥ng secret key
2. **HTTPS (Optional)**: CÃ³ thá»ƒ thÃªm SSL certificate
3. **Rate Limiting**: CÃ³ thá»ƒ thÃªm `express-rate-limit`
4. **Input Validation**: Server kiá»ƒm tra Ä‘á»™ dÃ i password (Ä‘Ãºng 9)
5. **CORS**: Chá»‰ allow cÃ¡c origin Ä‘Æ°á»£c phÃ©p

---

## ğŸ“ TÃ“M Táº®T QUY TRÃŒNH

```
START
  â†“
User vÃ o localhost:3000
  â”œâ”€ KhÃ´ng cÃ³ session? â†’ /dangnhap
  â””â”€ CÃ³ session? â†’ /GETinteractive
  
login form
  â†“
POST /xuly-dangnhap {username, password}
  â”œâ”€ Sai â†’ JSON {success: false}
  â””â”€ ÄÃºng â†’ Táº¡o session, JSON {success: true}
  
Chuyá»ƒn hÆ°á»›ng / (GETinteractive.html)
  â†“
Hiá»ƒn thá»‹ Hub menu
  â”œâ”€ Trang ChÃ­nh
  â”œâ”€ ThÆ° Viá»‡n
  â”œâ”€ Video
  â””â”€ CÃ i Äáº·t
  
User chá»n "Trang ChÃ­nh" â†’ mainpage.html
  â†“
Hiá»ƒn thá»‹ 5 container
  â†“
User báº¥m [ğŸ‘¤] Profile
  â†“
Container-5: Hiá»ƒn thá»‹ thÃ´ng tin user + [Logout]
  â†“
User báº¥m Logout â†’ /dangxuat
  â†“
Server xÃ³a session
  â†“
Quay láº¡i /dangnhap

END
```

---

## ğŸ“ LEARNING POINTS

- **Session**: LÆ°u trá»¯ thÃ´ng tin user trÃªn server
- **Middleware**: Xá»­ lÃ½ request trÆ°á»›c khi tá»›i endpoint
- **Bandwidth Control**: Throttle stream dá»¯ liá»‡u
- **Express Routing**: GET/POST endpoints
- **Client IP Tracking**: Äá»ƒ kiá»ƒm soÃ¡t per-device

---

ChÃºc báº¡n sá»­ dá»¥ng há»‡ thá»‘ng tá»‘t! ğŸš€
